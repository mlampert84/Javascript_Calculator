function evaluateCalcStack(){var evaluationString=calcStack.entries.join("");return evaluationString=evaluationString.replace("%","*0.01"),evaluationString=evaluationString.replace("π","3.1415926535"),evaluationString=evaluationString.replace("√","Math.sqrt"),evaluationString=evaluationString.replace("ln","Math.log"),evaluationString=evaluationString.replace("--","+"),eval(evaluationString)}function printCalcStack(){for(var c="",t=0;t<calcStack.entries.length;t++){var a=calcStack.entries[t].match(/^(\+|-|\/|\*)$/),e;e=t>0&&calcStack.entries[t-1].match(/^(\+|-|\/|\*)$/),c+=a||e?" "+calcStack.entries[t]:calcStack.entries[t]}return c}function calculator(c){var t=/\d/.test(c),a=calcStack.entries.length-1,e=/^-*((\d+)|(\d*\.\d*))$/.test(calcStack.entries[a]),l=1===calcStack.entries.length&&0!==calcStack.pastEntries.length&&!/Previous/.test(calcStack.pastEntries),n=/(\u03C0)|\)|%/.test(calcStack.entries[a]);if(t)l?(calcStack.pastEntries="Previous Answer: "+calcStack.entries[0],calcStack.entries[0]=c):n?calcStack.entries.push("*",c):e?0===calcStack.entries.length?calcStack.entries.push(c):calcStack.entries[a]+=c:0===calcStack.entries.length?calcStack.entries[0]=c:calcStack.entries.push(c);else if("allClear"===c)""===calcStack.entries[0]&&(calcStack.pastEntries=""),calcStack.entries=[""];else if("back"===c)1===calcStack.entries[a].length?calcStack.entries.pop():calcStack.entries[a].match(/(ln)|\u221A/)?calcStack.entries.pop():calcStack.entries[a]=calcStack.entries[a].slice(0,-1);else if("="===c){for(var i=calcStack.entries.join(),r=0;r<(i.match(/\(/g)||[]).length-(i.match(/\)/g)||[]).length;r++)calcStack.entries.push(")");var s=evaluateCalcStack();calcStack.entries.push(c),calcStack.pastEntries=printCalcStack(),calcStack.entries=[s.toString()]}else if("."===c){var u=/\.|\u03C0/.test(calcStack.entries[a]);0===calcStack.entries.length?calcStack.entries[0]=".":u||calcStack.entries.push(c)}else if("("===c)e||n?calcStack.entries.push("*","("):calcStack.entries.push("(");else if(")"===c){var k=calcStack.entries.join(""),o=(k.match(/\(/g)||[]).length,S=(k.match(/\)/g)||[]).length;"("===calcStack.entries[a]?calcStack.entries.push("0",c):(e||n)&&o>S&&calcStack.entries.push(c)}else if("pi"===c)e||l?calcStack.entries.push("*","π"):calcStack.entries.push("π");else if("%"===c)e?calcStack.entries.push(c):calcStack.entries.push("0"+c);else if("."===c);else if("sqRoot"===c)e||n?calcStack.entries.push("*","√("):calcStack.entries.push("√(");else if("ln"===c)e||n?calcStack.entries.push("*","ln("):calcStack.entries.push("ln(");else if("negate"===c)if(e||l||n)if(/-/.test(calcStack.entries[a])){var p=calcStack.entries[a].replace("-","");calcStack.entries[a]=p}else if("%"===calcStack.entries[a])calcStack.entries[a-1]="-"+calcStack.entries[a-1];else if(/\)/.test(calcStack.entries[a])){for(var f=0,r=0;r<a;r++)/\(/.test(calcStack.entries[r])&&(f=r);/-/.test(calcStack.entries[f])?calcStack.entries[f]=calcStack.entries[f].replace("-",""):calcStack.entries[f]="-"+calcStack.entries[f]}else calcStack.entries[a]="-"+calcStack.entries[a];else calcStack.entries[a]="-"+calcStack.entries[a];else calcStack.entries.push(c);$("#mainWindow").text(printCalcStack()),$("#enteredWindow").text(calcStack.pastEntries)}var calcStack={pastEntries:"",entries:[]};$("#inputZero").click(function(){calculator("0")}),$("#inputOne").click(function(){calculator("1")}),$("#inputTwo").click(function(){calculator("2")}),$("#inputThree").click(function(){calculator("3")}),$("#inputFour").click(function(){calculator("4")}),$("#inputFive").click(function(){calculator("5")}),$("#inputSix").click(function(){calculator("6")}),$("#inputSeven").click(function(){calculator("7")}),$("#inputEight").click(function(){calculator("8")}),$("#inputNine").click(function(){calculator("9")}),$("#inputDecimal").click(function(){calculator(".")}),$("#inputEquals").click(function(){calculator("=")}),$("#inputPlus").click(function(){calculator("+")}),$("#inputMinus").click(function(){calculator("-")}),$("#inputMultiply").click(function(){calculator("*")}),$("#inputDivide").click(function(){calculator("/")}),$("#inputPercent").click(function(){calculator("%")}),$("#inputPi").click(function(){calculator("pi")}),$("#inputSqRoot").click(function(){calculator("sqRoot")}),$("#inputLn").click(function(){calculator("ln")}),$("#inputNegate").click(function(){calculator("negate")}),$("#inputOpenParen").click(function(){calculator("(")}),$("#inputCloseParen").click(function(){calculator(")")}),$("#inputAllClear").click(function(){calculator("allClear")}),$("#inputBack").click(function(){calculator("back")}),$(function(){$(window).keypress(function(c){calculator(String.fromCharCode(c.which))})});